<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Service Rate</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="p-4 bg-light">

<div class="container p-4 bg-white rounded shadow">
  <h2 class="mb-4">Service Rate</h2>

  <!-- Client Info -->
  <div class="mb-3 row">
    <div class="col-md-5">
      <label for="clientName" class="form-label">Client Name</label>
      <input type="text" class="form-control" id="clientName" placeholder="Enter client name">
    </div>

    <div class="col-md-5">
      <label for="pickupLocation" class="form-label">Pick-Up Location</label>
      <select class="form-select" id="pickupLocation" onchange="updateZipCode()">
        <option selected disabled>Select a location</option>
        <optgroup label="Metro Manila Area">
          <option value="1773">Tunasan</option>
          <option value="1742">Zapote</option>
          <option value="1700">San Isidro</option>
        </optgroup>
        <optgroup label="Southern Luzon Area">
          <option value="4234">Sto. Tomas</option>
          <option value="4219">Balete</option>
          <option value="4232">Tanauan</option>
        </optgroup>
      </select>
    </div>

    <div class="col-md-2">
      <label for="zipCode" class="form-label">ZIP Code</label>
      <input type="text" class="form-control" id="zipCode" readonly>
    </div>
  </div>

  <!-- Vehicle Selection -->
  <div class="mb-4 row">
    <div class="col-md-4">
      <label for="vehicleType" class="form-label">Vehicle Type</label>
      <select id="vehicleType" class="form-select">
        <option value="L300">L300</option>
        <option value="4 Wheeler">4 Wheeler</option>
        <option value="6 Wheeler">6 Wheeler</option>
        <option value="6WF">6WF</option>
        <option value="10 Wheeler">10 Wheeler</option>
      </select>
    </div>

    <div class="col-md-4">
      <label for="customBaseRate" class="form-label">Base Rate</label>
      <input type="number" class="form-control" id="customBaseRate" placeholder="Enter base rate" />
    </div>

    <div class="col-md-4">
      <label for="customToll" class="form-label">Toll</label>
      <input type="number" class="form-control" id="customToll" placeholder="Enter toll amount" />
    </div>
  </div>

  <!-- Buttons -->
  <div class="gap-2 mb-4 d-flex">
    <button class="btn btn-primary" onclick="generateRateTable(true)">Generate City Table</button>
    <button class="btn btn-secondary" onclick="generateRateTable(false)">Show All Data</button>
  </div>

  <!-- Table Display -->
  <div id="rateTableContainer" style="display: none;">
    <h5 id="tableTitle">Rate Table</h5>
    <div class="table-responsive">
      <table class="table text-center align-middle table-bordered">
        <thead class="table-light" id="tableHead"></thead>
        <tbody id="rateTableBody"></tbody>
      </table>
    </div>
  </div>
</div>

<script>
  const vehicleRates = {
    "L300": { base: 100, rate: 20.20, toll: 50 },
    "4 Wheeler": { base: 120, rate: 25.32, toll: 60 },
    "6 Wheeler": { base: 150, rate: 30.33, toll: 70 },
    "6WF": { base: 180, rate: 35.70, toll: 80 },
    "10 Wheeler": { base: 200, rate: 40.34, toll: 100 }
  };

  const areas = {
    "Metro Manila Area": [
      { location: "Tunasan", city: "Muntinlupa City", distance: 15 },
      { location: "Zapote", city: "Las Piñas City", distance: 18 },
      { location: "San Isidro", city: "Parañaque City", distance: 20 }
    ],
    "Southern Luzon Area": [
      { location: "Sto. Tomas", city: "Batangas", distance: 60 },
      { location: "Balete", city: "Batangas", distance: 65 },
      { location: "Tanauan", city: "Batangas", distance: 55 }
    ]
  };

  const locationToAreaMap = {};
  for (const [areaName, locations] of Object.entries(areas)) {
    locations.forEach(loc => {
      locationToAreaMap[loc.location] = areaName;
    });
  }

  function updateZipCode() {
    const location = document.getElementById('pickupLocation');
    const selectedText = location.options[location.selectedIndex].text;
    document.getElementById('zipCode').value = location.value;
  }

  function generateRateTable() {
    const tableHead = document.getElementById('tableHead');
    const tableBody = document.getElementById('rateTableBody');
    const locationSelect = document.getElementById('pickupLocation');
    const selectedLocationText = locationSelect.options[locationSelect.selectedIndex].text;

    if (!selectedLocationText) return;

    const selectedArea = locationToAreaMap[selectedLocationText];
    const selectedLocation = areas[selectedArea].find(loc => loc.location === selectedLocationText);

    const selectedVehicle = document.getElementById('vehicleType').value;
    const baseInput = parseFloat(document.getElementById('customBaseRate').value) || vehicleRates[selectedVehicle].base;
    const tollInput = parseFloat(document.getElementById('customToll').value) || vehicleRates[selectedVehicle].toll;
    const ratePerKm = vehicleRates[selectedVehicle].rate;

    const total = (baseInput + (ratePerKm * selectedLocation.distance) + tollInput).toFixed(2);

    // Header
    const headers = ['Area', 'Location', 'City', 'Distance (km)', 'Rate/km', 'Toll', selectedVehicle];
    tableHead.innerHTML = `<tr>${headers.map(h => `<th>${h}</th>`).join('')}</tr>`;

    // Row
    const rowHTML = `
      <td>${selectedArea}</td>
      <td>${selectedLocation.location}</td>
      <td>${selectedLocation.city}</td>
      <td>${selectedLocation.distance}</td>
      <td>₱${ratePerKm}</td>
      <td>₱${tollInput}</td>
      <td><strong>₱${total}</strong></td>
    `;
    tableBody.innerHTML = `<tr>${rowHTML}</tr>`;

    document.getElementById('rateTableContainer').style.display = 'block';
  }
</script>


</body>
</html>
